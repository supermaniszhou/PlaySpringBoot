<!DOCTYPE html>
<html lang="en" xmlns:th="http://www.thymeleaf.org">
<head th:include="/common/main_head::mainHeader"></head>

<body>
<div id="wrapperZlc">
    <div id="page-innerZlc">
        <div style="margin-top: 10px;">
            <div class="layui-form-item">
                <div class="layui-inline">
                    <label class="layui-form-label">菜单名称</label>
                    <div class="layui-input-inline">
                        <input type="tel" name="menuName" lay-verify="required|phone" autocomplete="off" class="form-control">
                    </div>
                </div>
                <div class="layui-inline">
                    <label class="layui-form-label">菜单名称</label>
                    <div class="layui-input-inline">
                        <input type="text" name="email" lay-verify="email" autocomplete="off" class="form-control">
                    </div>
                </div>
                <div class="layui-inline">
                    <label class="layui-form-label">验证邮箱</label>
                    <div class="layui-input-inline">
                        <input type="text" name="email" lay-verify="email" autocomplete="off" class="form-control">
                    </div>
                </div>
                <div class="layui-inline">
                    <button type="button" class="btn btn-default"   onclick="sysMenuModle.SearchData();">
                        查询
                    </button>
                    &nbsp;&nbsp;&nbsp;
                    <a class="btn btn-primary" data-toggle="modal" onclick="sysMenuAddEdit.toAdd();">新增</a>
                </div>
            </div>



        </div>
        <div class="row">
            <div class="col-md-12">
                <table id="SysMenutable">
                </table>
            </div>
        </div>
    </div>
</div>


<div class="modal fade" id="sysMenuAdd" tabindex="-1"
     role="dialog" aria-labelledby="myModalLabel" aria-hidden="true">
    <div class="modal-dialog" style="width: 700px;">
        <div class="modal-content">
            <div class="modal-header">
                <button type="button" class="close" data-dismiss="modal" aria-hidden="true">
                    &times;
                </button>
                <h4 class="modal-title" id="myModalLabel">
                    新增
                </h4>
            </div>
            <div class="modal-body">
                <div class="container" style="height: 500px;overflow-y:scroll;">
                    <div class="row">
                        <section>
                            <div class="col-lg-6 col-lg-offset-1">
                                <form class="form-horizontal"
                                      id="sysMenuForm"
                                      style="margin-top: 10px;">
                                    <table>
                                        <tr hidden="hidden">
                                            <td class="tdZ" align="right">
                                                <label class="control-label"></label>
                                            </td>
                                            <td>
                                                <div class="form-group" style="margin-left: 50px">
                                                    <input class="form-control" name="id" id="id"
                                                           type="text" placeholder=""/>
                                                </div>
                                            </td>
                                            <td></td>
                                        </tr>
                                        <tr>
                                            <td class="tdZ" align="right">
                                                <label class="control-label">菜单名称</label>
                                            </td>
                                            <td>
                                                <div class="form-group" style="margin-left: 50px">
                                                    <input class="form-control" name="menuName" id="menuName"
                                                           type="text" placeholder=""/>
                                                </div>
                                            </td>
                                            <td></td>
                                        </tr>
                                        <tr>
                                            <td class="tdZ" align="right">
                                                <label class="control-label">等级</label>
                                            </td>
                                            <td>
                                                <div class="form-group" style="margin-left: 50px">
                                                    <input class="form-control" name="menuLevel" id="menuLevel"
                                                           type="text" placeholder=""/>
                                                </div>
                                            </td>
                                            <td></td>
                                        </tr>
                                        <tr>
                                            <td class="tdZ" align="right">
                                                <label class="control-label">父级</label>
                                            </td>
                                            <td>
                                                <div class="form-group" style="margin-left: 50px">
                                                    <!--<input class="form-control" name="menuParent" id="menuParent"-->
                                                    <!--type="text" placeholder=""/>-->
                                                    <input type="text" id="menuParent" name="menuParent"
                                                           class="form-control" value="" onclick="$('#treeview').show()"
                                                           placeholder="分类名称">
                                                    <!--<div id="treeview" style="">-->

                                                    <!--</div>-->
                                                    <div class="sidebar-collapse">
                                                        <ul class="nav" id="treeview">
                                                        </ul>
                                                    </div>
                                                </div>
                                            </td>
                                            <td></td>
                                        </tr>
                                        <tr>
                                            <td class="tdZ" align="right">
                                                <label class="control-label">排序</label>
                                            </td>
                                            <td>
                                                <div class="form-group" style="margin-left: 50px">
                                                    <input class="form-control" name="menuOrder" id="menuOrder"
                                                           type="text" placeholder=""/>
                                                </div>
                                            </td>
                                            <td></td>
                                        </tr>
                                        <tr hidden="hidden">
                                            <td class="tdZ" align="right">
                                                <label class="control-label">子级</label>
                                            </td>
                                            <td>
                                                <div class="form-group" style="margin-left: 50px">
                                                    <input class="form-control" name="menuChild" id="menuChild"
                                                           type="text" placeholder=""/>
                                                </div>
                                            </td>
                                            <td></td>
                                        </tr>
                                        <tr>
                                            <td class="tdZ" align="right">
                                                <label class="control-label">描述</label>
                                            </td>
                                            <td>
                                                <div class="form-group" style="margin-left: 50px">
                                                    <input class="form-control" name="memo" id="memo"
                                                           type="text" placeholder=""/>
                                                </div>
                                            </td>
                                            <td></td>
                                        </tr>
                                        <tr>
                                            <td class="tdZ" align="right">
                                                <label class="control-label">地址</label>
                                            </td>
                                            <td>
                                                <div class="form-group" style="margin-left: 50px">
                                                    <input class="form-control" name="menuUrl" id="menuUrl"
                                                           type="text" placeholder=""/>
                                                </div>
                                            </td>
                                            <td></td>
                                        </tr>
                                    </table>
                                </form>
                            </div>
                        </section>
                    </div>
                </div>
            </div>
            <div class="modal-footer">
            </div>
        </div>
    </div>
</div>
<script th:src="@{/js/sys/sysMenu/SysMenuList.js}"></script>
<script th:src="@{/js/sys/sysMenu/SysMenuAdd_Edit.js}"></script>
<script>
    var data1 = [];
    $(function () {
        $.post("/sysMenu/getMenuList", null, function (data) {
            // $('#treeview').treeview({
            //     data: data,         // data is not optional
            //     levels: 5,
            //     backColor: '#ffffff',
            //     color: '#030303',
            //     selectedBackColor: '#ffff2',
            //     highlightSelected: true,
            //     onhoverColor: '#6ccebc',
            //     // selectedIcon: 'glyphicon glyphicon-arrow-right'
            // });
            data1 = data;
        });
    });


    function buildDomTree() {
        alert(JSON.stringify(data1))
        var data = [];
        var root = "所有分类";

        function walk(nodes, data) {
            if (!nodes) {
                return;
            }
            $.each(nodes, function (id, node) {
                var obj = {
                    id: node.id,
                    text: node.text != null ? node.text : root
                    // 										tags : [ node.isLeaf == true ? node.
                    // 												+ ' child elements'
                    // 												: '' ]
                };
                if (node.isLeaf = true) {
                    obj.nodes = [];
                    walk(node.children, obj.nodes);
                }
                data.push(obj);
            });
        }

        walk(data1, data);
        return data;
    }


    $("#menuParent").click(function () {
        var options = {
            bootstrap2: false,
            showTags: true,
            levels: 5,
            showCheckbox: true,
            checkedIcon: "glyphicon glyphicon-check",
            data: buildDomTree(),
            onNodeSelected: function (event, data) {
                $("#menuParent").val(data.text);
                $("#treeview").hide();
            }
        };

        $('#treeview').treeview(options);
    });

</script>
</body>
</html>